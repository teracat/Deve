{
  "$schema": "http://json.schemastore.org/template",
  "author": "Jordi Badia Santaul√†ria",
  "classifications": [ "Common", "C#", "Item" ],
  "identity": "Deve.Template.ItemCrudCommand",
  "groupIdentity": "Deve.Templates.ItemCrudCommand",
  "name": ".NET DEVEloper Template (CRUD Command)",
  "shortName": "deve-crud-command",
  "tags": { "language": "C#", "type": "item" },

  "sourceName": "Deve",
  "preferNameDirectory": false,

  "symbols": {
    "MethodName": {
      "type": "derived",
      "valueSource": "name",
      "valueTransform": "Identity",
      "replaces": "METHOD_NAME",
      "fileRename": "METHOD_NAME"
    },
    "PluralItemName": {
      "type": "parameter",
      "valueSource": "text",
      "description": "Item name (plural)",
      "isRequired": "true",
      "replaces": "ITEM_NAME_PLURAL",
      "fileRename": "ITEM_NAME_PLURAL"
    },
    "SingularItemName": {
      "type": "parameter",
      "valueSource": "text",
      "description": "Item name (singular)",
      "isRequired": "true",
      "replaces": "ITEM_NAME_SINGULAR",
      "fileRename": "ITEM_NAME_SINGULAR"
    },
    "ModuleName": {
      "type": "parameter",
      "valueSource": "text",
      "isRequired": "true",
      "description": "Module name",
      "replaces": "MODULE_NAME",
      "fileRename": "MODULE_NAME"
    },
    "ProjectName": {
      "type": "parameter",
      "datatype": "text",
      "isRequired": "true",
      "description": "Project name (replaces 'Deve')",
      "replaces": "Deve",
      "fileRename": "Deve"
    }
  },

  "forms": {
    "Identity": { "identifier": "identity" }
  },

  "sources": [
    {
      "source": "./content",
      "modifiers": [
        { "exclude": [ "**/[Bb]in/**", "**/[Oo]bj/**", ".template.config/**" ] }
      ]
    }
  ],

  "postActions": [
    {
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D2",
      "description": "Add query to core",
      "args": {
        "executable": "dotnet",
        "args": "run InsertAfterHook.cs -- --extra-eol=start ./Modules/MODULE_NAME/ITEM_NAME_PLURAL/Core.cs \"<hooks:core-commands>\" \"    public async Task<Result> METHOD_NAMEAsync(Guid id, ITEM_NAME_SINGULARMETHOD_NAMERequest? request, CancellationToken cancellationToken)\r\n{\r\n    if (request is null)\r\n    {\r\n    return Result.Fail(options.LangCode, ResultErrorType.MissingRequiredField);\r\n    }\r\n    var command = request.ToMETHOD_NAMECommand(id);\r\n    return await mediator.SendAsync(command, cancellationToken);\r\n}\""
      },
      "applyFileRenamesToArgs": [ "args" ],
      "continueOnError": true,
      "manualInstructions": []
    },
    {
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D2",
      "description": "Add method to data interface",
      "args": {
        "executable": "dotnet",
        "args": "run InsertAfterHook.cs -- ./Common/MODULE_NAME/ITEM_NAME_PLURAL/IITEM_NAME_SINGULARData.cs \"<hooks:data-commands>\" \"    Task<Result> METHOD_NAMEAsync(Guid id, ITEM_NAME_SINGULARMETHOD_NAMERequest? request) => METHOD_NAMEAsync(id, request, CancellationToken.None);\r\n    Task<Result> METHOD_NAMEAsync(Guid id, ITEM_NAME_SINGULARMETHOD_NAMERequest? request, CancellationToken cancellationToken);\""
      },
      "applyFileRenamesToArgs": [ "args" ],
      "continueOnError": true,
      "manualInstructions": []
    },
    {
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D2",
      "description": "Add Method to module Constants",
      "args": {
        "executable": "dotnet",
        "args": "run InsertAfterHook.cs -- ./Common/MODULE_NAME/MODULE_NAMEConstants.cs \"<hooks:constants-method>\" \"    public static readonly string MethodMETHOD_NAME = \\\"METHOD_NAME\\\";\""
      },
      "applyFileRenamesToArgs": [ "args" ],
      "continueOnError": true,
      "manualInstructions": []
    },
    {
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D2",
      "description": "Add method to Sdk",
      "args": {
        "executable": "dotnet",
        "args": "run InsertAfterHook.cs -- ./Sdk/MODULE_NAME/ITEM_NAME_SINGULARSdk.cs \"<hooks:sdk-commands>\" \"    public async Task<Result> METHOD_NAMEAsync(Guid id, ITEM_NAME_SINGULARMETHOD_NAMERequest? request, CancellationToken cancellationToken) => await Patch(Path + id + Constants.MethodSeparator + MODULE_NAMEConstants.MethodMETHOD_NAME, RequestAuthType.Default, request, cancellationToken);\""
      },
      "applyFileRenamesToArgs": [ "args" ],
      "continueOnError": true,
      "manualInstructions": []
    },
    {
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D2",
      "description": "Add mapper",
      "args": {
        "executable": "dotnet",
        "args": "run InsertAfterHook.cs -- --extra-eol=start ./Modules/MODULE_NAME/ITEM_NAME_PLURAL/Mappers.cs \"<hooks:mappers>\" \"    public static METHOD_NAME.Command ToMETHOD_NAMECommand(this ITEM_NAME_SINGULARMETHOD_NAMERequest request, Guid id) => new()\r\n    {\r\n        Id = id,\r\n        Name = request.Name\r\n    };\""
      },
      "applyFileRenamesToArgs": [ "args" ],
      "continueOnError": true,
      "manualInstructions": []
    }
  ]
}
